# 安全

## 1、XSS

### 什么是 XSS

Cross-Site Scripting - 跨站脚本攻击

### 举例

用户提交恶意内容，显示在另一个用户的网页上，对用户的网页随意篡改。

用户 A 提交评论「 `< script >console.log(document.cookie)< /script >` 」，用户 B 来访问网站，这段脚本在 B 的浏览器直接执行，用户 A 的脚本就可以任意操作 B 的 cookie。

### 造成 XSS 的要点

1、用户可以提交恶意内容

2、提交的内容可以显示在另一个用户的页面上

3、这些内容**未经过滤**，直接运行在另一个用户的页面上

### 如何预防

通过过滤，将可疑的符号 `<` 符号变成 `&lt;` （HTML 实体）

## 2、什么是 CSRF

Cross Site Request Forgery - 跨站请求伪造

### 原理

一种劫持受信任用户向服务器发送非预期请求的攻击方式。

通常情况下，CSRF 攻击是攻击者 **借助受害者的 Cookie** 骗取服务器的信任，在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器，从而在并未授权的情况下执行在权限保护之下的操作。

### 解决方案

#### 添加 Token 验证

在 HTTP 请求中以参数的形式加入一个随机产生的 Token，并在服务器端建立一个拦截器来验证这个 Token，如果请求中没有 Token 或者 Token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求。

#### 步骤

**1、服务器将 Token 返回到前端**

用户打开页面时，前端发起请求，服务器会返回一个 Token，该 Token 通过加密算法对数据进行加密，一般 Token 会存在 Session 中。

**2、前端发请求时携带这个 Token**

对于 `GET` 请求，Token 将附在请求地址之后，所以尽量少用 `GET` 请求。

对于 **form** 标签发起的 `POST` 请求来说，要在 **form** 的最后加上：

```html
<input type="hidden" name="token" value="tokenvalue" />
```

总之，就是前端发请求时把 Token 以参数的形式加入请求中。

**3、服务器验证 Token 是否正确**

服务器需要判断 Token 的有效性。解密 Token，如果和加密字符串一致且时间未过期，那么这个 Token 就是有效的。
